> 字符流转，就此谱写逻辑华章

## 序言

从夏天的尾声到冬天，从图书馆的电脑到如今坐在工位上敲击键盘。编译陪伴着我走过了大三上，也陪伴着经历了许多心态和选择上的变化。此刻，我终于写完了编译器的代码，写完了设计文档、优化文档，听着窗外呼啸的冬天。我打开了感想文档。

就在昨天，编译结束了理论考试；在今晚，实验代码也将截止提交；此刻，编译即将截止，而我也终于有时间，不用再赶着冲刺编译实验进度，不用赶着生成目标代码，不用赶着做优化，而是可以慢慢地敲击键盘，回顾一下我的编译历程。

我并不是一个多么虔诚的编译器爱好者，完成编译代码的书写更多地是为了完成课程的任务。但是在实现的过程中，我也确实感受到了与原先的不同：在处理字符的过程中，实际上是在处理着程序员编写的逻辑。在冰冷的代码之下，跳动的字符指向了思维的华章。

## 课程感悟

编译和原先每周验收的计组、操作系统、面向对象都不同：在学期处就定下了整体的目标，然后在一个较长的DDL中可以自由发挥。

此外，在课程涉及上，编译也与原先的设计都截然不同的，原先更多是指向明确的要求，而编译器确实承载着逻辑转换的桥梁，让程序员书写的代码得以以汇编的形式出现，这对计算机的理解是很有益处的。

编译也是我有史以来完成的最大规模的代码，最后总计一万余行的代码确实是个庞然大物。在代码的书写过程中，我也制订了自己的规范，并坚持使用风格检查，让自己的代码变得更有条理性。我也熟悉了更多面向对象的知识，各种方法有着自己的使用规范和审美，确实会有赏心悦目之感。一直以来，我都自认为我的架构是极其优雅的，在写代码、借鉴他人优秀思路时，也总会说对方代码实在是太丑了，然后自己想尽办法去实现一个更加优雅的架构。

![lines](https://pigkiller-011955-1319328397.cos.ap-beijing.myqcloud.com/img/202412191633060.png)

实际上编译实验的难度并不是很大，但就是需要耐心地去做，去画大量时间做。但是当时间来到大三，面临着无数的选择，时间成为了最稀缺的事物。我也经常幻想“假如我有很多时间”，可以我并没有很多时间，我的编译也是多种取舍后的结果，只能取得一个勉强满意的结果。

在无数敲代码的夜晚，我也会怅惘：“未来的我会认可现在的选择吗”，但是没有如果啊，希望未来回头看时，可以有每一步都没有白走的坚定感。

## 学期感悟

书写编译感想，意味着一个学期又结束了，记得本学期刚开始时，我也还畅想着自己一学期要实现的任务。

在九月份，我并没有写很多的编译代码，只是简单地完成了词法分析的任务，想这“给自己放个假”，在国庆结束前弥补一下自己一点没有休息到的假期，也还充满着在11月之前写完编译的豪情壮志。

在十月份，我忙着畅想未来，给自己安排了好几场面试，也敲定了几个决定我现在的决定。我忙着在各个研讨室之间开会，忙着幻想着自己还没有到来的未来。至于现实中的编译，那时候的我并没有足够的时间去写。

在十一月，**时间突然就不够用了**，我的中间代码还没有成功生成——尽管我从十月中旬就开始一直叫嚣要在十一月之前冲完编译。那时候我的室友甚至优化都快做完了。于是开始了“赶赶赶”的冲刺之路，五天速通LLVM，三天速通MIPS，一周速通优化，在种种速通背后，是我兵荒马乱的一个学期——我太忙了！

忙并不是一件好事情，忙意味着自己没有对事情做出一个合理的安排。但是我总是这样，给自己找了太多的事情，最后抱怨着自己没有时间去做想做的事情。但是这都是我曾经做出的选择，我也没有任何理由去后悔，这些曾经的 选择都组成的现在的我，我很享受现在的我。

## 时间与象牙塔

这里是另外的一些碎碎念，写在大三上即将结束的2024年末尾。

时间真快啊！编译实验应该是我在象牙塔之中的最后一个大产出了。我越来越感觉到，自己就要走出象牙塔了。

我一直把大三上当作了自己在象牙塔中的最后一个学期，从下学期开始，保研，实习，未来选择，我的前面不再有一厢情愿的无限可能，而是只剩下了难以脱离的路径依赖。在学生时期，我还就可以保有热情地相信要学习知识，拒绝功利主义，但是随着从象牙塔中的逐渐走出，再也不会有如此单纯的追逐，可以投入大量的时间，实现一个感动自己的玩具。

这真是美好啊。在前两天的理论答疑时，大家挤满了一屋。尽管我也理解大家更多是处于对分数的渴望，可是君子论迹不论心，这样的纯粹，以脱离个人原始社会属性的方式去追逐身外之物，以后可能不会再有了。

记得上学期写OO的感想总结时，阳光特别好，我坐在教室里，看着初夏时窗外郁郁葱葱的枝丫，微风吹过，树叶沙沙作响，桌上的阳光流光抖落。每当学期最后写总结时，我总是想坐下来，什么都不做，就是呆呆地看着天空，仿佛无尽高远，可以寄托所有的情绪。

我抬头望向了窗外的天空，冬天的阴天灰蒙蒙的天，没有星星也没有月光，呼啸的风让室内的温暖更为踏实。

我无数次幻想过我书写编译总结时的场景，应该是一个窗外充满着星光的夜晚：编译的代码我绝大部分都是在晚上写的，看着清冷的月光，看着冬天的狂风，看着若隐若现的星星。我也无数次想过，自己最后究竟会写出一个什么样的编译器，编译出的程序能正常运行吗，优化能起作用吗。但直到此刻，我也才真正来到了这里，完成了编译器的书写。

## 课程建议

1. 希望中间代码生成给出更多指导，LLVM的教程过于简陋
2. 教程中讲解tolangC的部分不要涉及具体的语法，不然感觉像是助教在炫技
3. 对于竞速点的安排不要设置按照排名赋分，而是可以安排一定的优化梯度：做完某些优化后就可以得到多少分，否则会让内卷的强度太激烈了

以上就是我的感想，感谢助教和老师的陪伴！